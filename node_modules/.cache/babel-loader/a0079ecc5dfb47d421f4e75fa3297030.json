{"ast":null,"code":"import _slicedToArray from\"/Users/dmitriy/Desktop/test_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{Component}from'react';import{useState}from\"react\";import{firestore,storage}from'../index';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AddNewCart=function AddNewCart(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),description=_useState4[0],setDescription=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),price=_useState6[0],setPrice=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),sell=_useState8[0],setSell=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),date=_useState10[0],setDate=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),image=_useState12[0],setImage=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),imageError=_useState14[0],setImageError=_useState14[1];var types=['image/jpg','image/jpeg','image/png','image/PNG'];var handleProductImg=function handleProductImg(e){var selectedFile=e.target.files[0];if(selectedFile){if(selectedFile&&types.includes(selectedFile.type)){setImage(selectedFile);setImageError('');}}};var handleAddProducts=function handleAddProducts(e){e.preventDefault();var uploadTask=storage.ref(\"product-images/\".concat(image.name)).put(image);uploadTask.on('state_changed',function(snapshot){var progress=snapshot.bytesTransferred/snapshot.totalBytes*100;console.log(progress);},function(error){return setUploadError(error.message);},function(){storage.ref('product-images').child(image.name).getDownloadURL().then(function(url){firestore.collection('Products').add({title:title,description:description,price:Number(price),sell:Number(sell),date:Number(date),url:url}).then(function(){setSuccessMsg('Товар добавлен');setTitle('');setDescription('');setPrice('');setSell('');setDate('');document.getElementById('file').value='';setImageError('');setUploadError('');setTimeout(function(){setSuccessMsg('');},3000);}).catch(function(error){return setUploadError(error.message);});});});};var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),successMsg=_useState16[0],setSuccessMsg=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),uploadError=_useState18[0],setUploadError=_useState18[1];return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"hr\",{}),successMsg&&/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"success-msg\",children:successMsg})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"form\",{autoComplete:\"off\",className:\"form-group\",onSubmit:handleAddProducts,children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0418\\u043C\\u044F \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",required:true,minlength:\"20\",maxLength:\"60\",onChange:function onChange(e){return setTitle(e.target.value);},value:title}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",maxLength:\"200\",onChange:function onChange(e){return setDescription(e.target.value);},value:description}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u0426\\u0435\\u043D\\u0430 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",required:true,onChange:function onChange(e){return setPrice(e.target.value);},value:price}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u0421\\u043A\\u0438\\u0434\\u043A\\u0430\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"form-control\",onChange:function onChange(e){return setSell(e.target.value);},value:sell}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u0414\\u0430\\u0442\\u0430 \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F \\u0441\\u043A\\u0438\\u0434\\u043A\\u0438 (\\u0424\\u043E\\u0440\\u043C\\u0430\\u0442 \\u0413\\u0413\\u0413\\u0413.\\u041C\\u041C.\\u0414\\u0414)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",onChange:function onChange(e){return setDate(e.target.value);},value:date}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u0418\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"file\",className:\"form-control\",required:true,onChange:handleProductImg}),imageError&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"error-msg\",children:imageError})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'flex-end'},children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-success btn-md\",children:\"\\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C\"})})]}),uploadError&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"error-msg\",children:uploadError})]})]});};export default AddNewCart;","map":{"version":3,"sources":["/Users/dmitriy/Desktop/test_project/src/components/AddNewCart.js"],"names":["React","Component","useState","firestore","storage","AddNewCart","title","setTitle","description","setDescription","price","setPrice","sell","setSell","date","setDate","image","setImage","imageError","setImageError","types","handleProductImg","e","selectedFile","target","files","includes","type","handleAddProducts","preventDefault","uploadTask","ref","name","put","on","snapshot","progress","bytesTransferred","totalBytes","console","log","error","setUploadError","message","child","getDownloadURL","then","url","collection","add","Number","setSuccessMsg","document","getElementById","value","setTimeout","catch","successMsg","uploadError","display","justifyContent"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { useState } from \"react\";\nimport { firestore, storage } from '../index';\n\nconst AddNewCart = () => {\n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [price, setPrice] = useState('');\n    const [sell, setSell] = useState('');\n    const [date, setDate] = useState('');\n    const [image, setImage] = useState(null);\n    const [imageError, setImageError] = useState('');\n    const types = ['image/jpg', 'image/jpeg', 'image/png', 'image/PNG'];\n\n    const handleProductImg = (e) => {\n        let selectedFile = e.target.files[0];\n        if (selectedFile) {\n            if (selectedFile && types.includes(selectedFile.type)) {\n                setImage(selectedFile);\n                setImageError('');\n            }\n        }\n    }\n\n    const handleAddProducts = (e) => {\n        e.preventDefault();\n        const uploadTask = storage.ref(`product-images/${image.name}`).put(image);\n        uploadTask.on('state_changed', snapshot => {\n            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100\n            console.log(progress);\n        }, error => setUploadError(error.message), () => {\n            storage.ref('product-images').child(image.name).getDownloadURL().then(url => {\n                firestore.collection('Products').add({\n                    title,\n                    description,\n                    price: Number(price),\n                    sell: Number(sell),\n                    date: Number(date),\n                    url\n                }).then(() => {\n                    setSuccessMsg('Товар добавлен');\n                    setTitle('');\n                    setDescription('');\n                    setPrice('');\n                    setSell('');\n                    setDate('');\n                    document.getElementById('file').value = '';\n                    setImageError('');\n                    setUploadError('');\n                    setTimeout(() => {\n                        setSuccessMsg('');\n                    }, 3000)\n                }).catch(error => setUploadError(error.message));\n            })\n        })\n    }\n\n    const [successMsg, setSuccessMsg] = useState('');\n    const [uploadError, setUploadError] = useState('');\n    return (\n        <div className='container'>\n            <br></br>\n            <br></br>\n            <h1>Добавление товара</h1>\n            <hr></hr>\n            {successMsg && <>\n                <div className='success-msg'>{successMsg}</div>\n            </>}\n            <br></br>\n            <form autoComplete='off' className='form-group' onSubmit={handleAddProducts}>\n                <label>Имя товара</label>\n                <input type='text' className='form-control' required minlength=\"20\" maxLength=\"60\"\n                    onChange={(e) => setTitle(e.target.value)} value={title}></input>\n                <br></br>\n                <label>Описание товара</label>\n                <input type='text' className='form-control' maxLength=\"200\"\n                    onChange={(e) => setDescription(e.target.value)} value={description}></input>\n                <br></br>\n                <label>Цена товара</label>\n                <input type='number' className='form-control' required\n                    onChange={(e) => setPrice(e.target.value)} value={price}></input>\n                <br></br>\n                <label>Скидка</label>\n                <input type='number' className='form-control'\n                    onChange={(e) => setSell(e.target.value)} value={sell}></input>\n                <br></br>\n                <label>Дата окончания скидки (Формат ГГГГ.ММ.ДД)</label>\n                <input type='text' className='form-control'\n                    onChange={(e) => setDate(e.target.value)} value={date}></input>\n                <br></br>\n                <label>Изображение</label>\n                <input type='file' id='file' className='form-control' required\n                    onChange={handleProductImg} ></input>\n                {imageError && <>\n                    <br></br>\n                    <div className='error-msg'>{imageError}</div>\n                </>}\n                <br></br>\n                <div style={{ display: 'flex', justifyContent: 'flex-end' }}>\n                    <button type='submit' className='btn btn-success btn-md'>\n                        Добавить\n                    </button>\n                </div>\n            </form>\n            {uploadError && <>\n                <br></br>\n                <div className='error-msg'>{uploadError}</div>\n            </>}\n        </div>\n    );\n};\nexport default AddNewCart;"]},"metadata":{},"sourceType":"module"}